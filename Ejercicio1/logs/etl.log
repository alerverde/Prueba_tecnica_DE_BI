Extrayendo tablas desde la base origen...

DimDate extraída: 350 filas
DimCustomerSegment extraída: 19 filas
DimProduct extraída: 25 filas
Error extrayendo FactSales: (psycopg2.errors.UndefinedTable) relation "FactSales" does not exist
LINE 1: SELECT * FROM "FactSales"
                      ^

[SQL: SELECT * FROM "FactSales"]
(Background on this error at: https://sqlalche.me/e/20/f405)

 Extracción finalizada.

Iniciando pipeline ETL...

Traceback (most recent call last):
  File "/home/alejandrito/Mydata/mydata/Python/Prueba_tecnina_SUDATA/prueba_tecnica/prueba_tecnica2/Ejercicio1/main.py", line 11, in <module>
    main()
  File "/home/alejandrito/Mydata/mydata/Python/Prueba_tecnina_SUDATA/prueba_tecnica/prueba_tecnica2/Ejercicio1/main.py", line 7, in main
    load_all(dataframes)
  File "/home/alejandrito/Mydata/mydata/Python/Prueba_tecnina_SUDATA/prueba_tecnica/prueba_tecnica2/Ejercicio1/load.py", line 26, in load_all
    upsert_from_df(engine, FactSales, dataframes["FactSales"], "Salesid")
                                      ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'FactSales'
Extrayendo tablas desde la base origen...

DimDate extraída: 350 filas
DimCustomerSegment extraída: 19 filas
DimProduct extraída: 25 filas
FactSales extraída: 25 filas

 Extracción finalizada.

Iniciando pipeline ETL...


Pipeline ETL completado exitosamente.
Extrayendo tablas desde la base origen...

DimDate extraída: 350 filas
DimCustomerSegment extraída: 19 filas
DimProduct extraída: 25 filas
FactSales extraída: 25 filas

 Extracción finalizada.

Iniciando pipeline ETL...

Traceback (most recent call last):
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "FactSales" does not exist
LINE 1: INSERT INTO "FactSales" ("Salesid", "Dateid", "Productid", "...
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/alejandrito/Mydata/mydata/Python/Prueba_tecnina_SUDATA/prueba_tecnica/prueba_tecnica2/Ejercicio1/main.py", line 11, in <module>
    main()
  File "/home/alejandrito/Mydata/mydata/Python/Prueba_tecnina_SUDATA/prueba_tecnica/prueba_tecnica2/Ejercicio1/main.py", line 7, in main
    load_all(dataframes)
  File "/home/alejandrito/Mydata/mydata/Python/Prueba_tecnina_SUDATA/prueba_tecnica/prueba_tecnica2/Ejercicio1/load.py", line 26, in load_all
    upsert_from_df(engine, FactSales, dataframes["FactSales"], "Salesid")
  File "/home/alejandrito/Mydata/mydata/Python/Prueba_tecnina_SUDATA/prueba_tecnica/prueba_tecnica2/Ejercicio1/load.py", line 20, in upsert_from_df
    connection.execute(stmt)
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/home/alejandrito/anaconda3/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "FactSales" does not exist
LINE 1: INSERT INTO "FactSales" ("Salesid", "Dateid", "Productid", "...
                    ^

[SQL: INSERT INTO "FactSales" ("Salesid", "Dateid", "Productid", "Segmentid", "Price_PerUnit", "QuantitySold") VALUES (%(Salesid)s, %(Dateid)s, %(Productid)s, %(Segmentid)s, %(Price_PerUnit)s, %(QuantitySold)s) ON CONFLICT ("Salesid") DO UPDATE SET "Dateid" = excluded."Dateid", "Productid" = excluded."Productid", "Segmentid" = excluded."Segmentid", "Price_PerUnit" = excluded."Price_PerUnit", "QuantitySold" = excluded."QuantitySold"]
[parameters: {'Salesid': 'S1001', 'Dateid': 1, 'Productid': 1001, 'Segmentid': 19, 'Price_PerUnit': 299.99, 'QuantitySold': 3}]
(Background on this error at: https://sqlalche.me/e/20/f405)
